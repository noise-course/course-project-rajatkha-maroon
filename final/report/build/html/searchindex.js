Search.setIndex({"alltitles": {"1. Introduction": [[4, null]], "2. Dataset and flow extraction": [[0, null]], "3. Feature Generation with nPrint": [[2, null]], "3.1 Per-flow feature extraction": [[2, "per-flow-feature-extraction"]], "4. Dimensionality reduction with PCA": [[6, null]], "4.1. Scree plot on a sample": [[6, "scree-plot-on-a-sample"]], "4.1.1. Explained variance and scree plot": [[6, "explained-variance-and-scree-plot"]], "4.1.1. Sample of 50k flows": [[6, "sample-of-50k-flows"]], "4.2. Incremental PCA on the full dataset": [[6, "incremental-pca-on-the-full-dataset"]], "5. Models and training": [[5, null]], "5.1. Train and test splits": [[5, "train-and-test-splits"]], "5.2. Models": [[5, "models"]], "6. Results": [[8, null]], "7. Reproducing the netML baseline": [[7, null]], "8. Conclusion, discussion, and future work": [[1, null]], "8.1 Conclusion and discussion": [[1, "conclusion-and-discussion"]], "8.2 Future work": [[1, "future-work"]], "Contents": [[3, null]], "Merging per-flow CSVs with labels": [[2, "merging-per-flow-csvs-with-labels"]], "netML Malware Classification Project": [[3, null]]}, "docnames": ["dataset_and_flows", "discussion_conclusion", "features_nprint", "index", "introduction", "models_and_training", "pca_dim_reduction", "reproduction_netml", "results"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["dataset_and_flows.md", "discussion_conclusion.md", "features_nprint.md", "index.md", "introduction.md", "models_and_training.md", "pca_dim_reduction.md", "reproduction_netml.md", "results.md"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": 0, "0": [0, 2, 5, 6], "1": [0, 3], "1000": [1, 5], "100000": 0, "10000002068136406352_malware_emotet": [0, 2], "10000026091954898561_bengin_benign": 0, "1e": 5, "2": 2, "20": [1, 2, 6, 8], "200": [5, 6], "2000": 5, "20000": 6, "20k": 6, "3": 5, "300": 5, "4": 2, "400k": 6, "42": [5, 6], "50000": [2, 6], "6": [3, 5], "8": 5, "A": 2, "As": 4, "For": [1, 2], "In": 4, "No": [2, 6], "The": [0, 1, 2, 4, 6], "These": 2, "To": [4, 6], "With": 5, "_": [0, 2], "accuraci": 1, "achiev": 1, "across": 0, "address": 6, "after": 0, "afterward": 6, "all": [2, 6], "all_flow_features_easi": [2, 6], "all_flow_features_hard": 2, "along": 0, "alter": 1, "altern": 1, "an": [0, 1], "analysi": 6, "append": 6, "appli": [1, 4], "applic": 4, "ar": [1, 2, 4, 6], "autom": 2, "automat": 4, "automl": 1, "balanc": 1, "base": [1, 2, 4], "becaus": [1, 2], "befor": 6, "begin": 6, "below": 6, "benchmark": 1, "benefit": 1, "benign": [0, 1, 4], "best": 1, "better": 1, "between": 1, "binari": [0, 1, 4], "boost": [1, 4], "both": [4, 6], "boundari": 0, "break": 6, "build": [0, 6], "byte": [0, 1, 2, 4], "calcul": 6, "can": 1, "captur": [4, 6], "categori": 4, "chang": 1, "check": 2, "choic": 1, "chunk": [1, 6], "chunksiz": 6, "class": [1, 2, 4, 5, 6], "classic": [1, 4, 5], "classif": [1, 4], "classifi": 4, "closer": 0, "cmd": 2, "cnn": 1, "code": 6, "collect": 6, "colsample_bytre": 5, "column": 6, "combin": 2, "command": 2, "commod": 4, "commun": 4, "compar": 4, "complet": 6, "compon": [4, 6, 8], "concat": 6, "configur": 1, "consist": 1, "construct": 4, "continu": [2, 4, 6], "convert": [2, 4], "correl": 6, "creat": [2, 6], "creation": 2, "critic": 4, "cross": 1, "crucial": 1, "csv": 6, "csv_file": 2, "cum": 6, "cumsum": 6, "curv": 6, "data": [0, 1, 2, 4, 6], "datafram": 6, "dataset": [1, 2, 4, 5, 8], "decid": 6, "decomposit": 6, "deep": 4, "def": [0, 2, 5], "deliber": 4, "dens": [1, 6], "deriv": 4, "detect": 4, "df_out": 6, "dictionari": 2, "did": 1, "dimens": [1, 6], "dimension": [1, 4], "directori": 2, "do": 6, "doe": 1, "done": [2, 6], "dpi": 4, "dramat": 1, "drop": 6, "due": 4, "e": [0, 1], "each": [0, 2, 5], "easi": [0, 1, 2, 4, 5, 6], "easy_csv": 6, "easy_label": [2, 6], "easy_map": 2, "easy_pca_20_compon": 6, "easy_sampl": 6, "easy_sc": 6, "effici": 6, "either": 4, "els": 6, "emerg": 1, "encod": 0, "encrypt": 4, "end": 1, "ensembl": 5, "enumer": [0, 2], "error": 6, "essenti": [1, 2, 4], "etc": 1, "eval_metr": 5, "evalu": [1, 5], "even": 1, "eventu": 2, "evolut": 4, "exactli": 2, "examin": 6, "exhaust": 1, "exist": 2, "exist_ok": 2, "explained_variance_ratio_": 6, "explor": 1, "extract": 1, "f": [0, 2, 6], "f1": 1, "fals": 6, "famili": [0, 1, 4], "far": 6, "feasibl": 1, "featur": [1, 4, 6], "feature_dir": 2, "fetch": 0, "file": [0, 1, 2], "final": 6, "first": [2, 6], "first_writ": 6, "fit": [1, 6], "fit_transform": 6, "fix": [2, 4, 6], "flatten": 6, "flow": [1, 4, 8], "flow_dir": 2, "flow_featur": 2, "fname": [0, 2], "focu": 4, "follow": 5, "forest": [1, 4], "form": 2, "found": 2, "fraction": 6, "framework": 4, "from": [1, 2, 5, 6], "g": [0, 1], "gener": [1, 4], "get": 2, "get_model": 5, "glob": 2, "goal": 4, "grab": 6, "gradboost": 5, "gradient": [1, 4], "gradientboostingclassifi": 5, "gram": 1, "grid": 6, "ha": [0, 4], "half": 6, "handl": [1, 2], "hard": [0, 1, 2, 4, 5, 6], "hard_label": 2, "hard_map": 2, "hard_pca_20_compon": 6, "hardwar": 4, "has_xgb": 5, "hash": [1, 2, 4], "have": 6, "header": [1, 2, 6], "heavi": 6, "help": 0, "henc": 6, "here": 6, "high": 1, "higher": 1, "hist": 5, "how": [4, 6], "howev": 1, "hyper": 1, "i": [0, 1, 2, 4, 5, 6], "idea": 1, "ignor": 6, "ignore_index": 6, "imbal": 1, "implement": 0, "import": [0, 1, 2, 5, 6], "includ": [2, 6], "incorpor": 1, "increasingli": 4, "incrementalpca": [1, 6], "index": 6, "indic": 0, "ineffect": 4, "infrastructur": 4, "input": [1, 2], "inspect": 4, "instead": 6, "intend": 0, "interact": 1, "intern": 0, "introduct": 3, "intrus": 4, "io": 1, "ipv4": 2, "issu": [5, 6], "iter": [0, 2], "its": 6, "itself": 1, "just": [1, 6], "k": 6, "keep": 0, "kei": 1, "label": [0, 1, 4, 6], "labels_easi": 0, "labels_easy_path": 0, "labels_hard": 0, "labels_hard_path": 0, "laptop": 1, "larg": [1, 4, 6], "larger": 1, "le": 0, "leaderboard": 4, "learn": 4, "learning_r": 5, "len": [2, 6], "length": [1, 2, 4], "level": [0, 4], "lh": 0, "librari": 0, "like": 0, "limit": [2, 6], "line": [0, 2], "linear": [1, 5], "linear_model": 5, "load": 6, "log": 5, "log_loss": 5, "logic": 0, "logist": [1, 4, 5], "logisticregress": 5, "logloss": 5, "logreg": 5, "look": 0, "lookup": 2, "loop": 2, "loss": 5, "lot": 1, "lower": 1, "m": 0, "machin": 4, "macro": 1, "make": [1, 4, 6], "make_pipelin": 5, "malwar": [0, 1, 4], "manag": 4, "mani": [0, 4, 6], "marker": 6, "massiv": 4, "match": 1, "matplotlib": 6, "matric": [1, 6], "matrix": 6, "matter": 1, "max": 6, "max_compon": 6, "max_depth": 5, "max_it": 5, "meaning": 4, "memori": [1, 2, 5, 6], "merg": 6, "meta_str": 0, "metadata": 0, "method": 4, "min": 6, "mkdir": 2, "ml": [1, 5], "mode": 6, "model": [1, 4, 6, 8], "model_select": 5, "modern": 4, "modest": 1, "monitor": 4, "more": [2, 6], "most": 1, "move": 4, "much": 1, "multi": 4, "multipl": 1, "my": [0, 1], "n": [0, 1, 2, 6], "n_compon": 6, "n_estim": 5, "n_job": 5, "name": [0, 2], "need": 6, "netml": [0, 1, 4], "network": 4, "new": 2, "next": [1, 2], "none": [2, 5], "now": [5, 6], "np": [5, 6], "nprint": [1, 4, 6], "nprintml": [1, 4], "num": 2, "number": [1, 6], "numpi": [5, 6], "o": [0, 6], "obfusc": 4, "observ": 6, "obtain": 1, "offici": [1, 4], "often": 4, "onc": 6, "one": [0, 2, 4], "open": [0, 2], "option": 4, "origin": 1, "other": 1, "out_csv": 2, "out_easi": [2, 6], "out_hard": 2, "outlin": 4, "output": 2, "over": [0, 1, 2], "overlap": 1, "overshoot": 6, "own": 0, "p": 2, "packet": [0, 1, 2, 4], "pad": 1, "panda": 6, "paramet": 1, "parse_label": 0, "parser": 4, "part": [0, 6], "path": 2, "pathlib": 2, "payload": [1, 2], "pc": 6, "pca": [1, 4, 5, 8], "pca_easi": 6, "pcalml": 0, "pcap": [0, 2, 4], "pcap_path": 2, "pcapml": [0, 1, 4], "pcapml_f": 0, "pcapml_path": 0, "pcapng": 0, "pd": 6, "per": [6, 8], "perform": [1, 5, 8], "pipelin": [0, 1, 4, 5], "plt": 6, "plu": [0, 4], "point": [0, 1], "popul": 2, "port": 4, "possibl": 4, "practic": 1, "preprocess": [1, 4, 5, 6], "princip": 6, "print": [0, 2, 6], "process": 2, "progress": [0, 2], "project": [1, 4], "protect": 4, "protocol": 4, "provid": 0, "pyplot": 6, "python": 0, "quickli": 1, "r": 0, "rais": [2, 6], "ram": 6, "random": [1, 4, 6], "random_st": [5, 6], "randomforest": 5, "randomforestclassifi": 5, "rang": 6, "rather": 0, "ratio": 6, "raw": [0, 4], "re": 0, "reach": 1, "read": 6, "read_csv": 6, "readlin": 2, "recent": 4, "reduc": [1, 5, 6, 8], "reduct": [1, 4], "redund": 6, "regress": [1, 4, 5], "rel": 1, "relat": 4, "remain": 6, "remov": 6, "replic": 2, "report": 1, "repres": 6, "reproduc": 4, "reset_index": 6, "result": [1, 3, 4], "retain": 6, "return": [0, 2, 5], "reus": 0, "roughli": 6, "row": [2, 6], "rule": [1, 4], "run": [2, 5], "run_nprint": 2, "runtimeerror": 2, "same": 1, "sampl": 0, "sample_fram": 6, "sample_id": [2, 6], "sampleid": 0, "sampler": 0, "scale": 4, "scaler": 6, "scaler_easi": 6, "scheme": 6, "score": 1, "search": 1, "section": 8, "secur": 4, "select": [2, 6], "select_dtyp": 6, "separ": 0, "sequenc": 1, "set": [0, 1], "setup": 0, "sever": [1, 4, 5], "sgd": [1, 4], "sgd_logreg": 5, "sgdclassifi": 5, "shape": 6, "ship": 0, "should": 2, "show": 6, "sid": [0, 2], "similar": 1, "similarli": 6, "simpler": 1, "simplic": 6, "sinc": 6, "singl": [0, 2, 5], "size": 1, "sklearn": [5, 6], "small": 1, "so": 6, "sort": 2, "space": 1, "specif": 4, "specifi": 2, "split": [0, 2], "stage": 0, "standard": [1, 4], "standardscal": [5, 6], "start": [0, 1], "static": 1, "statist": 4, "stem": 2, "step": [1, 2], "stop": 6, "str": [0, 2], "straightforward": 6, "stratifi": 5, "stream": [2, 6], "string": 0, "strip": [0, 2], "struct": 0, "studi": 4, "sub": 6, "suboptim": 1, "subprocess": 2, "subsampl": 5, "substanti": 1, "suffer": 1, "suffici": 4, "summar": 8, "summari": 2, "t": 2, "target": 6, "target_sampl": 6, "task": [1, 4, 5, 6], "tcp": 2, "techniqu": 1, "test_siz": 5, "than": [0, 1], "them": [1, 2], "thi": [0, 1, 2, 4, 6, 8], "thousand": 6, "timeout": 0, "titl": 6, "to_csv": 6, "tol": 5, "tool": 1, "top": 6, "total": 6, "total_collect": 6, "toward": 4, "trace": 4, "track": 2, "tractabl": 4, "tradit": 4, "traffic": [0, 1, 4], "traffic_flow": [0, 2], "train": [1, 4, 6], "train_test_split": 5, "traninig": 2, "transform": [1, 6], "tree": 1, "tree_method": 5, "true": [2, 6], "two": [0, 4, 6], "txt": 0, "typic": 6, "u": 2, "udp": 2, "ultim": 6, "under": [2, 6], "unifi": 2, "up": [2, 6], "updat": 6, "us": [0, 1, 2, 4, 6], "usag": 6, "util": 0, "v": 1, "valid": [1, 5], "valu": 2, "vector": [1, 2, 4], "version": 1, "versu": 4, "volum": 4, "w": [0, 2, 6], "wa": 1, "we": 6, "well": 1, "were": 1, "when": [1, 6], "where": 2, "which": [0, 2, 4], "without": [1, 4, 5], "work": 4, "workflow": 6, "would": [1, 4], "wound": 2, "write": [0, 2, 4], "wrote": 0, "x": 6, "x_easi": 5, "x_hard": 5, "x_train_easi": 5, "x_train_hard": 5, "x_val_easi": 5, "x_val_hard": 5, "xgbclassifi": 5, "xgboost": [1, 4, 5], "xlabel": 6, "xp": 6, "y_easi": 5, "y_hard": 5, "y_train_easi": 5, "y_train_hard": 5, "y_val_easi": 5, "y_val_hard": 5, "yield": [1, 2], "ylabel": 6}, "titles": ["2. Dataset and flow extraction", "8. Conclusion, discussion, and future work", "3. Feature Generation with nPrint", "netML Malware Classification Project", "1. Introduction", "5. Models and training", "4. Dimensionality reduction with PCA", "7. Reproducing the netML baseline", "6. Results"], "titleterms": {"1": [1, 2, 4, 5, 6], "2": [0, 1, 5, 6], "3": 2, "4": 6, "5": 5, "50k": 6, "6": 8, "7": 7, "8": 1, "baselin": 7, "classif": 3, "conclus": 1, "content": 3, "csv": 2, "dataset": [0, 6], "dimension": 6, "discuss": 1, "explain": 6, "extract": [0, 2], "featur": 2, "flow": [0, 2, 6], "full": 6, "futur": 1, "gener": 2, "increment": 6, "introduct": 4, "label": 2, "malwar": 3, "merg": 2, "model": 5, "netml": [3, 7], "nprint": 2, "pca": 6, "per": 2, "plot": 6, "project": 3, "reduct": 6, "reproduc": 7, "result": 8, "sampl": 6, "scree": 6, "split": 5, "test": 5, "train": 5, "varianc": 6, "work": 1}})